Data Structure for Physiology
======================================================

Data Structure analyzed IO
------------------------------

- Directly read the corresponding behavioral data (see below) based on the ``DATA`` name

.. code-block:: text

    phys/
        ├── statistic/                     # (1)
        │
        ├── DATA_1 ([EXP_DATE]_[ANIMAL_ID]__[EXP_TYPE]_[USER])/
        │      ├── plane[N]/                # (2)
        │      ├── behavior/                # (3)
        │      ├── cache/                   # (4)
        │      ├── track/                   # (5)
        │      └── suite2p/                 # (6)
        │            └── plane[N]/ ...
        │
        ├── DATA_2/
        └── DATA_3/


Folder Details
^^^^^^^^^^^^^^^^^

- (1) ``statistic/``
  Stores statistical results and population-level visualization outputs across recordings.

- (2) ``plane[N]/``
  Physiological recording data for each optical plane (`N` = plane index).
  Data typically include neuronal activity traces, extracted signals, and ROI information.

- (3) ``behavior/``
  Animal behavior data synchronized to recording sessions, including running speed, position, task events, etc.

- (4) ``cache/``
  Cache files to avoid redundant computations (e.g., ``.pkl``, ``.npy``, or other serialized intermediate results).

- (5) ``track/``
  Camera-based tracking data such as pupil size, locomotion speed, and animal position. (e.g., ``pixviz``, ``facemap``)

- (6) ``suite2p/``
  Preprocessing outputs from pipelines like **Suite2p** or **Kilosort**.
  For Suite2p, each plane contains outputs like:

  - `F.npy` (raw fluorescence traces)
  - `Fneu.npy` (neuropil traces)
  - `ops.npy` (Suite2p operations/parameters)


.. note::

    - The naming convention for each dataset under `phys/` follows:
      `[EXP_DATE]_[ANIMAL_ID]__[EXP_TYPE]_[USER]`
      (e.g., `210315_YW006__2P_YW`).

    - Multiple optical planes (`plane0`, `plane1`, etc.) are processed and stored independently.

    - `statistic/` folder aggregates analysis across sessions and animals.




Data Structure for Behaviors
-------------------------------


.. code-block:: text


    presentation /
        ├── DATA_1 ([EXP_DATE]_[ANIMAL_ID]__[EXP_TYPE]_[USER])/
        │      ├── *.riglog                 # (1)
        │      ├── *.stimlog                # (2)
        │      ├── *.prot                   # (3)
        │      └── *.prefs                  # (4)
        │
        ├── DATA_2/
        └── DATA_3/


Folder Details
^^^^^^^^^^^^^^^^

- (1) ``.riglog``
  Experimental output file for behavioral hardware timestamp

- (2) ``.stimlig``
  Experimental output file for visual stimulation timestamp (need to be synced)

- (3) ``.prot``
  Experimental config file for protocol settings (i.e., visual stimulation, ...)

- (4) ``.prefs``
  Experimental config file for preference settings (i.e., hardware, io, ...)


.. note::

    This data generated by lab internal software **Stimpy**

.. seealso::

    Parsing package used `stimpyp <https://stimpyp.readthedocs.io/en/latest/>`_

